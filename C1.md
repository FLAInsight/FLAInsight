# Title

(C1) Reentrancy Vulnerabilities Exploited By Flash Loan Attacks

## Relationships

[1] [SWC-107: Reentrancy](https://swcregistry.io/docs/SWC-107/)

## Sample

### Incident

> [2021/12/19] Grim Finance Attack: https://learnblockchain.cn/article/3628

### Code

>  https://ftmscan.com/address/0x660184ce8af80e0b1e5a1172a16168b15f4136bf


#### Attack Process

![C1](https://github.com/user-attachments/assets/83fd6a66-c7a1-447a-9ced-3dc7c953905c)



Traditional reentrancy usually refers to the pattern of ``check balance ï¼ˆChecks) - transfer call (Interactions) - change balance (Effects)`` (SWC-107). Consequently, [existing best practices](https://docs.soliditylang.org/en/latest/security-considerations.html#use-the-checks-effects-interactions-pattern) recommend delaying ``Interactions`` after ``Effects``. 

However, in this incident, the code example exhibits the pattern ``collateralize (Interactions) - change shares (Effects) - obtain certificate (Interactions)``. The attack takes advantage of reentrancy in the initial interaction and profits from the final interaction. 

Therefore, although flash loan attacks leverage known vulnerabilities, the context of the affected contracts and the attack processes are more complex and diverse, which may surpass the detection capabilities of current tools.



